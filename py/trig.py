#! /usr/bin/python3
import numpy as np
import matplotlib.pyplot as plt

# x = np.linspace(0., 2.*np.pi, 400)
# y = 0.5 * np.pi - 23./180. * np.pi - x

# plt.plot(x / np.pi * 180., y / np.pi * 180., 'b-')
# plt.grid()
# plt.show()

bin_scan = {
    0 : {
        1 : [[28.271, 0.0520457], [61.7559, 0.0522573]],
        2 : [[27.6959, 0.0965399], [27.7294, 0.096255]],
        3 : [[21.0872, 0.0499035], [69.2717, 0.0498368]],
        4 : [[41.3524, 0.0716175], [41.4155, 0.0716051]],
        5 : [[20.0053, 0.0352787], [19.9315, 0.0352501]],
        6 : [[15.9238, 0.109294], [15.9231, 0.109956]],
        7 : [[62.25, 0.0596816], [62.3684, 0.0597857]],
        8 : [[28.3949, 0.0548593], [28.3948, 0.0548884]]
    },
    15 : {
        1 : [[61.9354, 0.0519188]],
        2 : [[27.4771, 0.0955709]],
        3 : [[69.7613, 0.0505411]],
        4 : [[19.3721, 0.0640438]],
        5 : [[20.0656, 0.0353103]],
        6 : [[16.2434, 0.115787]],
        7 : [[61.6928, 0.0590464]],
        8 : [[4.06606, 0.0834028]]
    },
    30 : {
        1 : [[27.625, 0.0507515]],
        2 : [[26.9467, 0.0957236]],
        3 : [[20.1867, 0.0512045]],
        4 : [[19.5265, 0.0639126]],
        5 : [[20.3285, 0.0354225]],
        6 : [[17.253, 0.129267]],
        7 : [[27.8192, 0.0584228]],
        8 : [[4.32867, 0.0825564]]
    },
    45 : {
        1 : [[63.412, 0.0488836]],
        2 : [[26.1667, 0.0968986]],
        3 : [[-19.516, 0.0516263]],
        4 : [[19.9227, 0.0638675]],
        5 : [[20.8771, 0.035729]],
        6 : [[18.3505, 0.145098]],
        7 : [[61.2509, 0.0584672]],
        8 : [[5.47925, 0.0808668]]
    },
    60 : {
        1 : [[25.6311, 0.0469772]],
        2 : [[25.0505, 0.0987695]],
        3 : [[70.4486, 0.0516238]],
        4 : [[20.4547, 0.0636232]],
        5 : [[21.521, 0.0360614]],
        6 : [[0,0]],
        7 : [[61.4777, 0.0586038]],
        8 : [[7.73507, 0.0785575]]
    },
    75 : {
        1 : [[65.6953, 0.045091]],
        2 : [[24.1964, 0.100252]],
        3 : [[20.1267, 0.0514385]],
        4 : [[39.8797, 0.0727698]],
        5 : [[67.402, 0.0364728]],
        6 : [[23.835, 0.165223]],
        7 : [[62.0727, 0.059071]],
        8 : [[26.1201, 0.0554033]]
    },
    90 : {
        1 : [[23.0772, 0.0432786]],
        2 : [[22.5277, 0.099397]],
        3 : [[69.8119, 0.0507353]],
        4 : [[21.9804, 0.0633212]],
        5 : [[23.121, 0.0370772]],
        6 : [[24.9344, 0.13573]],
        7 : [[62.7442, 0.0597409]],
        8 : [[24.8493, 0.0555534]]
    },
    105 : {
        1 : [[68.3068, 0.0417819]],
        2 : [[21.1908, 0.0974338]],
        3 : [[21.1243, 0.0500416]],
        4 : [[22.8177, 0.0631272]],
        5 : [[65.7027, 0.0376556]],
        6 : [[25.5196, 0.118124]],
        7 : [[63.852, 0.0609536]],
        8 : [[15.8823, 0.0781791]]
    },
    120 : {
        1 : [[69.3099, 0.0407013]],
        2 : [[19.6456, 0.0940584]],
        3 : [[68.4651, 0.0489216]],
        4 : [[23.7458, 0.0629152]],
        5 : [[64.8063, 0.0383987]],
        6 : [[25.9799, 0.108089]],
        7 : [[24.1532, 0.0622843]],
        8 : [[18.8756, 0.0793263]]
    },
    135 : {
        1 : [[70.1927, 0.0398277]],
        2 : [[18.4846, 0.0911612]],
        3 : [[22.7112, 0.0481645]],
        4 : [[34.4297, 0.0904058]],
        5 : [[25.4567, 0.0389288]],
        6 : [[25.9685, 0.100409]],
        7 : [[22.7921, 0.0642844]],
        8 : [[21.7372, 0.0804392]]
    },
    150 : {
        1 : [[19.2004, 0.0391618]],
        2 : [[17.3289, 0.0881844]],
        3 : [[23.5482, 0.0472486]],
        4 : [[25.36, 0.0626599]],
        5 : [[26.0513, 0.0394956]],
        6 : [[25.9767, 0.0957411]],
        7 : [[21.4183, 0.066631]],
        8 : [[24.4634, 0.0813463]]
    },
    165 : {
        1 : [[71.4302, 0.0387074]],
        2 : [[16.6655, 0.0864769]],
        3 : [[66.1926, 0.04648]],
        4 : [[3.85467, 0.0745263]],
        5 : [[26.3513, 0.0397879]],
        6 : [[25.6991, 0.0921568]],
        7 : [[68.8151, 0.0688872]],
        8 : [[26.6118, 0.0817136]]
    },
    180 : {
        1 : [[71.5562, 0.0385375]],
        2 : [[16.4944, 0.0870533]],
        3 : [[65.6398, 0.0459872]],
        4 : [[26.3116, 0.062544]],
        5 : [[26.4021, 0.0398825]],
        6 : [[25.559, 0.091155]],
        7 : [[-20.1524, 0.0711806]],
        8 : [[28.234, 0.0823362]]
    },
    195 : {
        1 : [[71.4328, 0.0385394]],
        2 : [[16.5432, 0.087708]],
        3 : [[65.1033, 0.0455093]],
        4 : [[26.4297, 0.0625133]],
        5 : [[63.3931, 0.0397168]],
        6 : [[25.1273, 0.09021]],
        7 : [[70.6817, 0.07334]],
        8 : [[28.8722, 0.0827302]]
    },
    210 : {
        1 : [[19.112, 0.0389352]],
        2 : [[17.0836, 0.0822178]],
        3 : [[25.5441, 0.0453573]],
        4 : [[3.53742, 0.0740901]],
        5 : [[63.7044, 0.0393928]],
        6 : [[24.7695, 0.0902109]],
        7 : [[17.5294, 0.0761121]],
        8 : [[17.2519, 0.0555462]]
    },
    225 : {
        1 : [[19.8025, 0.0393913]],
        2 : [[18.3205, 0.0964406]],
        3 : [[64.674, 0.0451395]],
        4 : [[4.26524, 0.0746296]],
        5 : [[64.3036, 0.0388108]],
        6 : [[23.9835, 0.092673]],
        7 : [[17.4885, 0.0762554]],
        8 : [[27.933, 0.0843764]]
    },
    240 : {
        1 : [[20.7297, 0.0402233]],
        2 : [[19.5617, 0.102526]],
        3 : [[64.7205, 0.0451664]],
        4 : [[32.631, 0.107539]],
        5 : [[24.5978, 0.0381506]],
        6 : [[23.6106, 0.0962984]],
        7 : [[71.3124, 0.075571]],
        8 : [[26.303, 0.0854698]]
    },
    255 : {
        1 : [[68.3878, 0.0412399]],
        2 : [[21.3263, 0.111384]],
        3 : [[64.9297, 0.0452875]],
        4 : [[24.8103, 0.0635636]],
        5 : [[23.838, 0.0375689]],
        6 : [[22.58, 0.100443]],
        7 : [[70.884, 0.074525]],
        8 : [[19.7313, 0.0549047]]
    },
    270 : {
        1 : [[23.0435, 0.0427432]],
        2 : [[23.6503, 0.120106]],
        3 : [[25.0234, 0.0456937]],
        4 : [[23.8957, 0.0637636]],
        5 : [[66.7038, 0.0369721]],
        6 : [[21.7857, 0.105378]],
        7 : [[69.8795, 0.0720456]],
        8 : [[21.2331, 0.0546134]]
    },
    285 : {
        1 : [[65.9223, 0.044273]],
        2 : [[25.3622, 0.11989]],
        3 : [[24.5197, 0.0461659]],
        4 : [[22.957, 0.0640615]],
        5 : [[67.4448, 0.0364923]],
        6 : [[20.5453, 0.110518]],
        7 : [[20.4276, 0.0691837]],
        8 : [[16.3727, 0.0828553]]
    },
    300 : {
        1 : [[64.5761, 0.0463342]],
        2 : [[26.5782, 0.113885]],
        3 : [[24.0261, 0.0465445]],
        4 : [[22.1142, 0.0642175]],
        5 : [[68.1953, 0.0360217]],
        6 : [[19.4865, 0.113499]],
        7 : [[21.9171, 0.066381]],
        8 : [[24.1697, 0.0544324]]
    },
    315 : {
        1 : [[26.5993, 0.0482109]],
        2 : [[27.305, 0.107575]],
        3 : [[23.2104, 0.0473972]],
        4 : [[21.4213, 0.0643729]],
        5 : [[68.776, 0.0357278]],
        6 : [[18.0316, 0.111755]],
        7 : [[23.2111, 0.06425]],
        8 : [[9.87592, 0.0802774]]
    },
    330 : {
        1 : [[62.5524, 0.0502301]],
        2 : [[27.6957, 0.102185]],
        3 : [[22.5133, 0.0481515]],
        4 : [[20.7502, 0.0642539]],
        5 : [[69.267, 0.0354549]],
        6 : [[16.989, 0.109895]],
        7 : [[64.3972, 0.0623058]],
        8 : [[26.8016, 0.0546189]]
    },
    345 : {
        1 : [[28.1095, 0.0476558]],
        2 : [[27.8167, 0.0979914]],
        3 : [[68.7388, 0.0491638]],
        4 : [[40.8805, 0.0717794]],
        5 : [[20.1012, 0.0353448]],
        6 : [[16.4085, 0.110465]],
        7 : [[63.3705, 0.0610019]],
        8 : [[4.99041, 0.0829256]]
    }
}

full_simple = {
    0   : [[23.6128, 0.0191962], [23.614, 0.0191973]],
    15  : [[23.622, 0.0192232]],
    30  : [[23.5905, 0.0192381]],
    45  : [[23.5194, 0.0192769]],
    60  : [[23.4103, 0.019318]],
    75  : [[23.2596, 0.0193288]],
    90  : [[23.1426, 0.0187767]],
    105 : [[22.9263, 0.0193846]],
    120 : [[22.8622, 0.0194282]],
    135 : [[22.716, 0.0194328]],
    150 : [[22.5945, 0.0194447]],
    165 : [[22.4602, 0.0194313]],
    180 : [[22.4056, 0.0194249]],
    195 : [[22.3968, 0.0193891]],
    210 : [[22.4082, 0.0193437]],
    225 : [[22.4723, 0.019313]],
    240 : [[22.5709, 0.0192856]],
    255 : [[22.6921, 0.0192472]],
    270 : [[22.8552, 0.0191982]],
    285 : [[23.0057, 0.0191854]],
    300 : [[23.2267, 0.0191594]],
    315 : [[23.3584, 0.019159]],
    330 : [[23.5093, 0.0191578]],
    345 : [[23.5761, 0.019176]]
}

approx_scan = {
    0 : {
        "beta" : [23.0364, 0.0194978],
          "rb" : [0.0500824, 0.000210892],
        "delb" : [0.58922, 0.317838]
    },

    # 15 : {
    #     "beta" : [23.6253, 0.0192065],
    #       "rb" : [4.52693e-14, 1.09076e-06],
    #     "delb" : [265.338, 0.589483]
    # },

    30 : {
        "beta" : [23.0153, 0.0194194],
          "rb" : [0.0505039, 0.000192478],
        "delb" : [30.3516, 0.309185]
    },

    45 : {
        "beta" : [22.9881, 0.0193755],
          "rb" : [0.0500913, 0.000220383],
        "delb" : [45.2681, 0.306078]
    },

    60 : {
        "beta" : [22.9977, 0.01941],
          "rb" : [0.05039, 0.00024],
        "delb" : [60.270, 0.284]
    },

    75 : {
        "beta" : [23.0556, 0.019284],
          "rb" : [0.0499445, 0.000259635],
        "delb" : [75.089, 0.261994]
    },

    # 90 : {
    #     "beta" : [],
    #       "rb" : [],
    #     "delb" : []
    # },

    105 : {
        "beta" : [22.9462, 0.0191618],
          "rb" : [0.0498629, 0.000279155],
        "delb" : [105.221, 0.23668]
    },

    120 : {
        "beta" : [23.0071, 0.0193531],
          "rb" : [0.0495705, 0.000287296],
        "delb" : [119.965, 0.241409]
    },

    135 : {
        "beta" : [23.0067, 0.0191459],
          "rb" : [0.0500149, 0.00022851],
        "delb" : [135.331, 0.274687]
    },

    150 : {
        "beta" : [22.9874, 0.0190973],
          "rb" : [0.0493291, 0.000250657],
        "delb" : [150.817, 0.283783]
    },

    165 : {
        "beta" : [22.9761, 0.0191115],
          "rb" : [0.0498439, 0.000230196],
        "delb" : [165.644, 0.301664]
    },

    180 : {
        "beta" : [22.953, 0.019],
          "rb" : [0.0499327, 0.000211883],
        "delb" : [180.624, 0.3166]
    },

    195 : {
        "beta" : [22.9461, 0.0191973],
          "rb" : [0.05013, 0.000186497],
        "delb" : [195.172, 0.321863]
    },

    210 : {
        "beta" : [22.9844, 0.0192333],
          "rb" : [0.05005, 0.0002043],
        "delb" : [210.865, 0.320168]
    },

    # 225 : {
    #     "beta" : [],
    #       "rb" : [],
    #     "delb" : []
    # },

    240 : {
        "beta" : [23.000187, 0.01940],
          "rb" : [0.0505671, 0.00023664],
        "delb" : [240.3555, 0.2907]
    },

    255 : {
        "beta" : [23.0131, 0.01947],
          "rb" : [0.0501291, 0.000259542],
        "delb" : [255.097, 0.2679]
    },

    270 : {
        "beta" : [23.0075, 0.0194553],
          "rb" : [0.05013, 0.000272181],
        "delb" : [270.236, 0.23847]
    },

    285 : {
        "beta" : [23.027, 0.0196],
          "rb" : [0.0494458, 0.000282081],
        "delb" : [284.853, 0.231]
    },

    300 : {
        "beta" : [23.017, 0.0196],
          "rb" : [0.0495237, 0.000278606],
        "delb" : [300.362, 0.2357]
    },

    315 : {
        "beta" : [23.04566, 0.01908],
          "rb" : [0.0498353, 0.000266385],
        "delb" : [315.6848, 0.2501]
    },

    330 : {
        "beta" : [23.02179, 0.0195],
          "rb" : [0.0498275, 0.000247208],
        "delb" : [330.177, 0.2759]
    },

    345 : {
        "beta" : [23.0169, 0.0195372],
          "rb" : [0.0498524, 0.00022517],
        "delb" : [345.835, 0.301241]
    },
}

zero_rb = {
    0 : [[23.022, 0.019],  # full DP
         [23.026, 0.019]
        ],
    1 : [[23.089, 0.043],
         [23.029, 0.043],
         [23.081, 0.043],
         [67.026, 0.043],
         [23.002, 0.043],
         [67.035, 0.043],
         [67.109, 0.040],
         [67.100, 0.043],
         [67.022, 0.043],
         [22.992, 0.043],
         [67.092, 0.043],
         [23.029, 0.043],
         [67.101, 0.043],
         [22.966, 0.043]
        ],
    2 : [[22.959, 0.107],
         [23.099, 0.109],
         [22.865, 0.107],
         [22.916, 0.108],
         [23.001, 0.108],
         [22.935, 0.107],
         [22.872, 0.107],
         [23.000, 0.108],
         [22.982, 0.108],
         [23.033, 0.108],
         [23.130, 0.108],
         [23.119, 0.109],
         [23.203, 0.109]
        ],
    3 : [[67.462, 0.048],
         [67.542, 0.048],
         [22.987, 0.048],
         [67.462, 0.048],
         [67.412, 0.048],
         [23.012, 0.048],
         [23.061, 0.048],
         [67.480, 0.048],
         [67.495, 0.048],
         [67.488, 0.048],
         [22.942, 0.048],
         [67.510, 0.048],
         [67.501, 0.048],
         [67.537, 0.048]
        ],
    4 : [[37.148, 0.078],
         [22.906, 0.064],
         [37.198, 0.078],
         [22.968, 0.064],
         [8.4972, 0.084],
         [37.058, 0.078],
         [36.903, 0.078],
         [37.089, 0.078],
         [37.051, 0.078],
         [23.024, 0.064],
         [22.927, 0.064],
         [22.877, 0.064],
         [37.169, 0.078],
         [37.063, 0.078]
        ],
    5 : [[23.027, 0.037],
         [23.003, 0.037],
         [23.054, 0.037],
         [22.945, 0.037],
         [23.024, 0.037],
         [22.969, 0.037],
         [22.965, 0.037],
         [22.974, 0.037],
         [66.608, 0.037],
         [23.021, 0.037],
         [66.616, 0.037],
         [22.979, 0.037],
         [66.614, 0.037]
        ],
    6 : [[23.035, 0.122],
         [23.353, 0.123],
         [23.019, 0.120],
         [23.034, 0.123],
         [22.913, 0.121],
         [22.888, 0.123],
         [22.936, 0.121],
         [23.237, 0.123],
         [23.022, 0.122],
         [22.894, 0.122],
         [22.686, 0.121],
         [22.950, 0.123],
         [23.056, 0.120]
        ],
    7 : [[22.927, 0.064],
         [66.026, 0.064],
         [23.049, 0.064],
         [22.972, 0.064],
         [23.022, 0.064],
         [66.010, 0.064],
         [23.020, 0.064],
         [65.939, 0.064],
         [22.920, 0.064],
         [23.129, 0.064],
         [23.080, 0.064],
         [22.975, 0.064],
         [65.948, 0.064]
        ],
    8 : [[22.948, 0.055],
         [23.051, 0.055],
         [22.959, 0.055],
         [16.095, 0.081],
         [23.024, 0.055],
         [16.166, 0.080],
         [15.835, 0.080],
         [15.882, 0.080],
         [15.931, 0.080],
         [16.032, 0.080],
         [22.958, 0.055],
         [22.990, 0.055],
         [22.939, 0.055],
         [23.012, 0.055]
        ]
}

def plot_simple_scan():
    x = sorted(full_simple.keys())
    yval = [full_simple[key][0][0] for key in x]
    yerr = [full_simple[key][0][1] for key in x]
    plt.figure(num=0)
    plt.errorbar(x, yval, 0, yerr, 'bo')
    plt.title("Full Dalitz plot")
    plt.grid()
    # plt.show()

    x = sorted(bin_scan.keys())
    print(x)
    for binn in range(1, 9):
        yval = [bin_scan[key][binn][0][0] for key in x]
        yerr = [bin_scan[key][binn][0][1] for key in x]

        plt.figure(num=binn)
        plt.errorbar(x, yval, 0, yerr, 'bo')
        plt.title("bin " + str(binn))
        plt.grid()

def plot_approx_scan():
    x = np.array(sorted(approx_scan.keys()))
    beta = [approx_scan[key]['beta'][0] for key in x]
    betae = [approx_scan[key]['beta'][1] for key in x]

    rb = [approx_scan[key]['rb'][0] for key in x]
    rbe = [approx_scan[key]['rb'][1] for key in x]

    deltab = np.array([approx_scan[key]['delb'][0] for key in x])
    deltabe = [approx_scan[key]['delb'][1] for key in x]

    plt.figure(num=1)
    plt.errorbar(x, beta, xerr=0, yerr=betae, fmt='ko')
    plt.grid()
    plt.title(r'Angle $\beta$')
    plt.savefig('beta_approx.eps')

    plt.figure(num=2)
    plt.errorbar(x, rb, xerr=0, yerr=rbe, fmt='ko')
    plt.grid()
    plt.title(r'$r_B$')
    plt.savefig('rb_approx.eps')

    plt.figure(num=3)
    plt.errorbar(x, deltab-x, xerr=0, yerr=deltabe, fmt='ko')
    plt.grid()
    plt.title(r'$\delta_B$')
    plt.savefig('deltab_approx.eps')

def plot_null_fit():
    x, y, e = [[] for _ in range(3)]

    for key, array in zero_rb.items():
        for val, err in array:
            x, y, e = x+[key], y+[val], e+[err]

    plt.errorbar(x, y, xerr=0, yerr=e, fmt='ko')
    plt.plot([0, 8], [23, 23], 'b--')
    plt.plot([0, 8], [67, 67], 'r--')
    plt.grid()
    plt.title('Null fit')

scan_null = {
    'full' : [854029, 852796, 851609, 850472, 849384, 848346, 847360, 846425, 845545, 844718, 843946, 843231, 842572, 841970, 841426, 840940, 840512, 840142, 839829, 839574, 839377, 839236, 839150, 839121, 839145, 839224, 839355, 839538, 839771, 840054, 840384, 840761, 841183, 841647, 842153, 842696, 843275, 843886, 844528, 845195, 845885, 846595, 847321, 848060, 848809, 849568, 850334, 851109, 851892, 852686, 853493, 854314, 855152, 856009, 856888, 857788, 858713, 859663, 860638, 861639, 862666, 863718, 864796, 865899, 867025, 868175, 869347, 870541, 871756, 872991, 874246, 875521, 876814, 878126, 879456, 880803, 882166, 883543, 884934, 886335, 887746, 889162, 890583, 892004, 893423, 894836, 896241, 897635, 899016, 900381, 901730, 903060, 904371, 905664, 906937, 908193, 909433, 910656, 911864, 913058, 914240, 915409, 916566, 917710, 918842, 919959, 921062, 922147, 923214, 924259, 925281, 926278, 927247, 928186, 929092, 929965, 930802, 931600, 932359, 933077, 933749, 934375, 934949, 935469, 935928, 936321, 936640, 936876, 937020, 937060, 936985, 936782, 936440, 935950, 935302, 934494, 933524, 932397, 931121, 929706, 928167, 926516, 924769, 922940, 921041, 919086, 917084, 915044, 912976, 910887, 908782, 906667, 904546, 902424, 900304, 898189, 896082, 893986, 891903, 889836, 887788, 885761, 883758, 881782, 879835, 877920, 876038, 874192, 872385, 870616, 868889, 867203, 865561, 863962, 862407, 860897, 859432, 858012, 856638, 855311, 854029],
    '1' : [213584, 213189, 212813, 212457, 212121, 211805, 211509, 211233, 210977, 210741, 210524, 210327, 210148, 209988, 209846, 209722, 209615, 209524, 209450, 209391, 209347, 209317, 209300, 209296, 209303, 209320, 209347, 209383, 209426, 209475, 209530, 209588, 209649, 209712, 209776, 209838, 209899, 209957, 210011, 210060, 210103, 210139, 210168, 210190, 210203, 210208, 210204, 210192, 210172, 210144, 210108, 210066, 210018, 209965, 209907, 209847, 209784, 209721, 209658, 209597, 209538, 209483, 209433, 209389, 209352, 209324, 209305, 209297, 209300, 209315, 209344, 209386, 209443, 209515, 209603, 209708, 209830, 209970, 210127, 210304, 210499, 210713, 210947, 211200, 211473, 211767, 212080, 212413, 212767, 213140, 213533, 213946, 214379, 214831, 215302, 215791, 216299, 216824, 217367, 217926, 218501, 219091, 219695, 220313, 220942, 221583, 222234, 222894, 223561, 224234, 224911, 225590, 226270, 226949, 227625, 228295, 228957, 229609, 230248, 230871, 231477, 232061, 232622, 233157, 233662, 234135, 234573, 234974, 235334, 235652, 235926, 236153, 236332, 236462, 236542, 236570, 236548, 236475, 236351, 236178, 235957, 235689, 235377, 235022, 234626, 234193, 233724, 233223, 232692, 232134, 231552, 230949, 230328, 229690, 229040, 228379, 227710, 227035, 226357, 225677, 224997, 224319, 223646, 222978, 222317, 221665, 221023, 220392, 219773, 219167, 218575, 217998, 217437, 216892, 216365, 215855, 215363, 214890, 214435, 214000, 213584],
    '2' : [84828.1, 84729.6, 84637.5, 84551.8, 84472.4, 84399.2, 84331.9, 84270.5, 84214.7, 84164.4, 84119.3, 84079.2, 84043.8, 84013, 83986.3, 83963.6, 83944.6, 83929, 83916.4, 83906.7, 83899.6, 83894.7, 83891.9, 83890.9, 83891.5, 83893.6, 83897, 83901.7, 83907.4, 83914.3, 83922.4, 83931.6, 83942, 83953.8, 83967, 83981.8, 83998.5, 84017.1, 84037.8, 84061, 84086.7, 84115.2, 84146.6, 84181.2, 84219.2, 84260.6, 84305.7, 84354.6, 84407.3, 84464.1, 84525, 84590.1, 84659.4, 84733, 84811, 84893.3, 84980.1, 85071.3, 85167, 85267.2, 85371.9, 85481.2, 85595.1, 85713.6, 85836.9, 85964.9, 86097.9, 86235.7, 86378.6, 86526.6, 86679.8, 86838.3, 87002.1, 87171.4, 87346.3, 87526.6, 87712.6, 87904.2, 88101.5, 88304.3, 88512.8, 88726.7, 88946, 89170.6, 89400.3, 89635, 89874.3, 90118.1, 90366, 90617.7, 90872.8, 91130.9, 91391.4, 91653.9, 91917.8, 92182.4, 92447.1, 92711, 92973.5, 93233.6, 93490.5, 93743.1, 93990.5, 94231.5, 94465.2, 94690.4, 94905.9, 95110.5, 95303.2, 95482.7, 95648, 95798, 95931.7, 96048.2, 96146.8, 96226.9, 96287.8, 96329.2, 96351, 96353, 96335.5, 96298.7, 96243, 96169, 96077.5, 95969.1, 95844.9, 95705.7, 95552.6, 95386.6, 95208.7, 95020.1, 94821.6, 94614.5, 94399.5, 94177.7, 93949.9, 93716.9, 93479.5, 93238.5, 92994.4, 92747.9, 92499.5, 92249.7, 91999, 91747.8, 91496.4, 91245.3, 90994.7, 90745, 90496.4, 90249.2, 90003.7, 89760.2, 89518.9, 89280.1, 89044, 88811, 88581.3, 88355.2, 88132.9, 87914.7, 87700.9, 87491.8, 87287.5, 87088.4, 86894.6, 86706.3, 86523.8, 86347.3, 86176.8, 86012.6, 85854.7, 85703.2, 85558.3, 85420, 85288.3, 85163.3, 85044.9, 84933.2, 84828.1],
    '3' : [105904, 105902, 105893, 105877, 105854, 105826, 105792, 105753, 105711, 105666, 105620, 105572, 105524, 105478, 105434, 105392, 105354, 105321, 105293, 105270, 105255, 105247, 105246, 105254, 105271, 105297, 105333, 105379, 105435, 105502, 105581, 105670, 105772, 105885, 106010, 106147, 106297, 106459, 106634, 106822, 107022, 107236, 107462, 107702, 107954, 108220, 108499, 108791, 109095, 109413, 109744, 110087, 110443, 110811, 111192, 111584, 111988, 112404, 112830, 113267, 113714, 114171, 114637, 115112, 115594, 116082, 116577, 117077, 117581, 118087, 118595, 119102, 119607, 120109, 120604, 121092, 121569, 122034, 122483, 122913, 123322, 123706, 124063, 124388, 124679, 124933, 125147, 125319, 125447, 125528, 125562, 125549, 125489, 125382, 125230, 125034, 124798, 124523, 124213, 123870, 123498, 123100, 122679, 122238, 121780, 121308, 120825, 120332, 119833, 119330, 118823, 118316, 117809, 117304, 116802, 116305, 115813, 115328, 114850, 114380, 113919, 113468, 113026, 112595, 112174, 111765, 111367, 110982, 110608, 110246, 109897, 109561, 109238, 108927, 108629, 108345, 108073, 107814, 107569, 107337, 107117, 106911, 106717, 106537, 106369, 106213, 106071, 105940, 105822, 105715, 105620, 105537, 105465, 105403, 105353, 105313, 105282, 105261, 105249, 105246, 105251, 105263, 105282, 105308, 105339, 105375, 105415, 105458, 105504, 105551, 105598, 105646, 105691, 105735, 105775, 105811, 105842, 105867, 105886, 105899, 105904],
    '4' : [44359.4, 44256.1, 44157, 44062.1, 43971.8, 43886, 43805, 43728.8, 43657.5, 43591.1, 43529.7, 43473.4, 43422.1, 43375.8, 43334.6, 43298.4, 43267.2, 43240.9, 43219.5, 43203.1, 43191.5, 43184.8, 43182.9, 43185.9, 43193.6, 43206.3, 43223.8, 43246.2, 43273.5, 43305.9, 43343.2, 43385.6, 43433, 43485.6, 43543.2, 43605.9, 43673.7, 43746.5, 43824.3, 43907.1, 43994.8, 44087.3, 44184.4, 44286, 44392, 44502.1, 44616.2, 44734, 44855.2, 44979.4, 45106.2, 45235.3, 45366, 45498, 45630.4, 45762.6, 45893.9, 46023.4, 46150, 46273, 46391, 46503.2, 46608.3, 46705.3, 46793.1, 46870.9, 46937.7, 46993.1, 47036.7, 47068.4, 47088.4, 47097.1, 47095.2, 47083.4, 47062.9, 47034.5, 46999.5, 46959, 46913.9, 46865.5, 46814.5, 46762, 46708.8, 46655.5, 46602.9, 46551.5, 46501.8, 46454.3, 46409.4, 46367.2, 46328.2, 46292.4, 46260, 46231.2, 46205.9, 46184.2, 46166, 46151.2, 46139.6, 46131, 46125.1, 46121.7, 46120.4, 46120.6, 46122.1, 46124.3, 46126.6, 46128.5, 46129.5, 46129.2, 46127.2, 46123, 46116.6, 46107.8, 46096.6, 46083.3, 46068.1, 46051.5, 46033.9, 46015.9, 45997.8, 45980.4, 45964.1, 45949.4, 45936.7, 45926.5, 45919.2, 45914.9, 45914, 45916.7, 45923.1, 45933.4, 45947.6, 45965.7, 45987.6, 46013.4, 46042.9, 46076, 46112.3, 46151.8, 46193.9, 46238.4, 46284.8, 46332.6, 46381.1, 46429.8, 46477.9, 46524.5, 46568.8, 46609.8, 46646.4, 46677.6, 46702.3, 46719.3, 46727.7, 46726.5, 46714.9, 46692.4, 46658.6, 46613.5, 46557.2, 46490, 46412.8, 46326.2, 46231.2, 46128.9, 46020.4, 45906.7, 45789, 45668.2, 45545.3, 45421.2, 45296.7, 45172.5, 45049.3, 44927.7, 44808.2, 44691.2, 44577.2, 44466.5, 44359.4],
    '5' : [118690, 118279, 117888, 117518, 117167, 116837, 116527, 116236, 115965, 115713, 115480, 115267, 115072, 114895, 114737, 114598, 114475, 114371, 114283, 114213, 114159, 114121, 114098, 114091, 114099, 114121, 114156, 114204, 114264, 114335, 114416, 114506, 114604, 114708, 114817, 114929, 115041, 115153, 115260, 115361, 115452, 115531, 115595, 115642, 115670, 115677, 115664, 115631, 115579, 115511, 115428, 115334, 115232, 115123, 115012, 114900, 114789, 114682, 114580, 114485, 114398, 114320, 114253, 114197, 114154, 114123, 114106, 114104, 114116, 114144, 114187, 114247, 114323, 114416, 114527, 114655, 114801, 114966, 115148, 115350, 115570, 115809, 116068, 116346, 116644, 116961, 117298, 117656, 118033, 118431, 118850, 119289, 119748, 120229, 120730, 121252, 121795, 122358, 122943, 123549, 124176, 124823, 125491, 126180, 126889, 127619, 128368, 129137, 129926, 130733, 131559, 132402, 133261, 134137, 135027, 135930, 136845, 137770, 138702, 139639, 140578, 141514, 142444, 143362, 144262, 145136, 145977, 146775, 147519, 148197, 148798, 149307, 149713, 150004, 150173, 150214, 150126, 149911, 149576, 149130, 148586, 147956, 147252, 146487, 145673, 144818, 143934, 143027, 142104, 141172, 140234, 139296, 138360, 137431, 136509, 135598, 134699, 133815, 132945, 132091, 131254, 130435, 129635, 128853, 128091, 127349, 126626, 125924, 125243, 124582, 123942, 123323, 122725, 122147, 121591, 121056, 120541, 120047, 119574, 119122, 118690],
    '6' : [78803.8, 78723.2, 78648.8, 78580.4, 78517.9, 78461.1, 78409.8, 78363.7, 78322.6, 78286.2, 78254.3, 78226.5, 78202.5, 78181.9, 78164.6, 78150.1, 78138, 78128.2, 78120.3, 78114.1, 78109.3, 78105.8, 78103.5, 78102.2, 78102, 78102.8, 78104.9, 78108.3, 78113.2, 78120, 78128.7, 78139.8, 78153.6, 78170.3, 78190.4, 78214, 78241.6, 78273.5, 78309.9, 78351.1, 78397.5, 78449.1, 78506.3, 78569.3, 78638.2, 78713.1, 78794.3, 78881.8, 78975.8, 79076.2, 79183.1, 79296.7, 79416.7, 79543.3, 79676.4, 79816, 79961.9, 80114.1, 80272.5, 80436.9, 80607.3, 80783.4, 80965.3, 81152.7, 81345.5, 81543.6, 81747.1, 81955.7, 82169.5, 82388.4, 82612.4, 82841.7, 83076.1, 83315.8, 83560.8, 83811.2, 84066.9, 84328.1, 84594.8, 84866.9, 85144.4, 85427.2, 85715.2, 86008.2, 86306.1, 86608.5, 86915.1, 87225.5, 87539.3, 87855.9, 88174.8, 88495.2, 88816.3, 89137.4, 89457.4, 89775.2, 90089.8, 90399.7, 90703.5, 90999.9, 91287.1, 91563.4, 91827, 92076, 92308.6, 92522.8, 92716.7, 92888.5, 93036.3, 93158.8, 93254.5, 93322.4, 93361.6, 93371.8, 93352.8, 93304.9, 93228.7, 93125.1, 92995.4, 92840.9, 92663.3, 92464.4, 92246, 92010.1, 91758.6, 91493.4, 91216.3, 90929.1, 90633.4, 90330.8, 90022.8, 89710.7, 89395.7, 89079, 88761.6, 88444.3, 88128.1, 87813.6, 87501.4, 87192.1, 86886.2, 86584.1, 86286.1, 85992.6, 85703.7, 85419.6, 85140.4, 84866.3, 84597.2, 84333.3, 84074.4, 83820.6, 83571.8, 83328, 83089.2, 82855.2, 82626.2, 82402, 82182.8, 81968.5, 81759.2, 81555, 81356, 81162.3, 80974.2, 80791.6, 80614.8, 80443.9, 80279.1, 80120.4, 79968.1, 79822.1, 79682.6, 79549.7, 79423.3, 79303.6, 79190.6, 79084.1, 78984.2, 78890.8, 78803.8],
    '7' : [88046.9, 88042.8, 88034.6, 88022.5, 88006.7, 87987.4, 87965, 87939.9, 87912.4, 87883, 87852.2, 87820.4, 87788.2, 87756.1, 87724.5, 87694, 87665, 87637.9, 87613.4, 87591.7, 87573.3, 87558.6, 87547.9, 87541.6, 87540.1, 87543.6, 87552.5, 87566.9, 87587.2, 87613.5, 87646.1, 87685.2, 87731, 87783.5, 87843, 87909.6, 87983.3, 88064.3, 88152.6, 88248.4, 88351.6, 88462.2, 88580.4, 88706.1, 88839.2, 88979.9, 89127.9, 89283.3, 89445.9, 89615.7, 89792.5, 89976.3, 90166.8, 90363.9, 90567.3, 90776.9, 90992.3, 91213.3, 91439.6, 91670.9, 91906.6, 92146.5, 92390.1, 92636.9, 92886.3, 93137.8, 93390.7, 93644.4, 93898, 94150.9, 94402.3, 94651.1, 94896.5, 95137.4, 95372.9, 95601.7, 95822.9, 96035.1, 96237.2, 96428.1, 96606.5, 96771.1, 96920.9, 97054.8, 97171.7, 97270.7, 97351, 97411.9, 97452.9, 97473.6, 97473.9, 97453.7, 97413.3, 97352.9, 97273.1, 97174.6, 97058.2, 96924.8, 96775.4, 96611.1, 96433.1, 96242.6, 96040.7, 95828.7, 95607.8, 95379.1, 95143.8, 94903, 94657.7, 94409, 94157.7, 93904.8, 93651.1, 93397.4, 93144.5, 92892.9, 92643.4, 92396.6, 92152.9, 91912.9, 91677, 91445.6, 91219.2, 90998, 90782.4, 90572.7, 90369, 90171.8, 89981.1, 89797.2, 89620.1, 89450.2, 89287.3, 89131.8, 88983.5, 88842.7, 88709.4, 88583.5, 88465.2, 88354.3, 88250.9, 88155, 88066.5, 87985.3, 87911.4, 87844.7, 87785.1, 87732.3, 87686.4, 87647.2, 87614.4, 87587.9, 87567.5, 87553, 87544, 87540.4, 87541.8, 87548, 87558.6, 87573.2, 87591.6, 87613.2, 87637.7, 87664.7, 87693.7, 87724.2, 87755.8, 87787.9, 87820.1, 87851.9, 87882.7, 87912.1, 87939.6, 87964.8, 87987.2, 88006.5, 88022.4, 88034.5, 88042.8, 88046.9, 88046.9],
    '8' : [120559, 120436, 120316, 120200, 120087, 119979, 119875, 119776, 119682, 119593, 119510, 119433, 119361, 119296, 119236, 119183, 119137, 119097, 119063, 119036, 119016, 119002, 118995, 118995, 119001, 119014, 119033, 119059, 119092, 119130, 119175, 119226, 119283, 119346, 119414, 119488, 119567, 119651, 119740, 119833, 119931, 120032, 120137, 120245, 120356, 120469, 120584, 120701, 120818, 120936, 121053, 121170, 121285, 121399, 121511, 121619, 121724, 121825, 121921, 122013, 122099, 122179, 122252, 122319, 122379, 122432, 122478, 122516, 122547, 122571, 122587, 122597, 122599, 122595, 122585, 122569, 122547, 122520, 122489, 122454, 122416, 122374, 122330, 122284, 122237, 122188, 122139, 122090, 122041, 121992, 121945, 121899, 121855, 121813, 121773, 121735, 121700, 121668, 121638, 121612, 121588, 121568, 121551, 121537, 121526, 121518, 121514, 121512, 121514, 121518, 121526, 121536, 121550, 121566, 121584, 121606, 121630, 121657, 121687, 121719, 121754, 121791, 121830, 121872, 121917, 121964, 122012, 122063, 122116, 122170, 122226, 122284, 122342, 122402, 122462, 122522, 122582, 122642, 122701, 122758, 122814, 122867, 122918, 122965, 123009, 123049, 123083, 123113, 123137, 123155, 123166, 123170, 123168, 123157, 123139, 123113, 123079, 123036, 122986, 122928, 122862, 122788, 122707, 122619, 122525, 122424, 122318, 122207, 122091, 121972, 121848, 121723, 121594, 121465, 121334, 121203, 121071, 120941, 120812, 120684, 120559]
}

def plot_scan():
    for key, scan in sorted(scan_null.items()):
        plt.plot(list(range(181)), scan, 'b-')
        plt.title(key)
        plt.grid()
        plt.savefig(key + '100.eps', )
        plt.show()

# plot_simple_scan()
# plot_approx_scan()
# plot_null_fit()
plot_scan()
plt.show()
